@model Comision.Model.Domain.Settings
@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}
<link href="~/Content/assets/global/plugins/bootstrap-fileinput/bootstrap-fileinput.css" rel="stylesheet" type="text/css" />
<div class="row">
    <div class="col-md-12">
        <div class="portlet light ">
            @using (Html.BeginForm(MVC.Admin.Settings.AddorUpdate(), FormMethod.Post, new {id = "SettingForm", enctype = "multipart/form-data"}))
            {
                @Html.AntiForgeryToken()
                @Html.HiddenFor(x => x.UniversityId)
                @Html.HiddenFor(x => x.University.Id)
                @Html.HiddenFor(m => m.University.Logo)
                <div class="portlet-title">
                    <div class="caption">
                        <i class="icon-social-dribbble font-purple-soft"></i>
                        <span class="caption-subject font-purple-soft bold uppercase">تنظیمات</span>
                    </div>
                    <div class="actions" style="float: left">
                        <div class="actions">
                            <button type="submit" class="btn btn-circle btn-default">
                                <i class="fa fa-save"></i> ذخیره
                            </button>
                        </div>
                    </div>
                </div>
                <div class="portlet-body">
                    <ul class="nav nav-tabs">
                        <li class="active">
                            <a href="#tab_1_1" data-toggle="tab"> اطلاعات دانشگاه </a>
                        </li>
                        @*<li>
                            <a href="#tab_1_2" data-toggle="tab"> پیامک </a>
                        </li>*@
                        <li>
                            <a href="#tab_1_3" data-toggle="tab"> تنظیمات ارسال ایمیل </a>
                        </li>
                        <li>
                            <a href="#tab_1_4" data-toggle="tab"> کمیسیون </a>
                        </li>
                        <li>
                            <a href="#tab_1_5" data-toggle="tab"> شورا </a>
                        </li>
                        <li>
                            <a href="#tab_1_6" data-toggle="tab"> کارتابل </a>
                        </li>
                    </ul>
                    <div class="tab-content">

                        <div class="tab-pane fade active in" id="tab_1_1">
                            <div class="form-horizontal">
                                <div class="form-body">
                                    <div class="form-group">
                                        <label class="col-md-4 control-label">لوگوی دانشگاه</label>
                                        <div class="col-md-8">
                                            <div class="fileinput fileinput-new" data-provides="fileinput">
                                                <div class="fileinput-new thumbnail" style="width: 200px; height: 150px;">
                                                    <img id="imgLogo" src="~/Content/Images/Logo/@Model.University.Logo" class="header-avatar"/>
                                                </div>
                                                <div id="divImageLogo" class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px; max-height: 150px; line-height: 10px;"></div>
                                                <div>
                                                    <span class="btn default btn-file">
                                                        <span class="fileinput-new"> انتخاب لوگو </span>
                                                        <span class="fileinput-exists"> تغییر </span>
                                                        <input type="hidden" value="" name="..."><input id="fileLogo" type="file" name="fileLogo">
                                                    </span>
                                                    <a href="javascript:;" id="deleteLogo" data-id="@Model.UniversityId" class="btn red" onclick="DeleteLogo();"> حذف </a>
                                                    @*<a href="javascript:;" class="btn red fileinput-exists" data-dismiss="fileinput"> حذف </a>*@
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-md-3 control-label">نام دانشگاه</label>
                                        <div class="col-md-9">
                                            @Html.TextBoxFor(m => m.University.Name, new { @class = "form-control"})                                            
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-md-3 control-label">آدرس</label>
                                        <div class="col-md-9">
                                            @Html.TextBoxFor(m => m.University.Address, new { @class = "form-control" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        @*<div class="tab-pane fade" id="tab_1_2">
                            <div class="form-horizontal">
                                <div class="form-body">
                                    <div class="form-group">
                                        <label class="col-md-3 control-label">نام کاربری</label>
                                        <div class="col-md-9">                      
                                            @Html.TextBoxFor(m => m.SmsUserName, new { @class = "form-control" })
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-md-3 control-label">کلمه عبور</label>
                                        <div class="col-md-9">
                                            @Html.TextBoxFor(m => m.SmsPass, new { @class = "form-control" })
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-md-3 control-label">شماره سامانه</label>
                                        <div class="col-md-9">
                                            @Html.TextBoxFor(m => m.SmsNumber, new { @class = "form-control" })
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-md-3 control-label">متن پیامک</label>
                                        <div class="col-md-9">
                                            @Html.TextBoxFor(m => m.TextSms, new { @class = "form-control" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>*@
                        <div class="tab-pane fade" id="tab_1_3">
                            <div class="form-horizontal">
                                <div class="form-body">
                                    <div class="form-group">
                                        <label class="col-md-3 control-label">هاست</label>
                                        <div class="col-md-3">
                                         @Html.TextBoxFor(m => m.SmtpHost, new { @class = "form-control" })
                                        </div>
                                        <label class="col-md-3 control-label">آدرس ایمیل فرستنده</label>
                                        <div class="col-md-3">
                                            @Html.TextBoxFor(m => m.SmtpUserName, new { @class = "form-control" })
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-md-3 control-label">نام کاربری</label>
                                        <div class="col-md-3">
                                            @Html.TextBoxFor(m => m.SmtpFrom, new { @class = "form-control" })
                                        </div>
                                        <label class="col-md-3 control-label">رمز عبور</label>
                                        <div class="col-md-3">
                                            @Html.TextBoxFor( m => m.SmtpPass, new { @class = "form-control" })
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-md-3 control-label">شماره پورت</label>
                                        <div class="col-md-3">
                                            @Html.TextBoxFor(m => m.SmtpPort, new { @class = "form-control" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="tab_1_4">
                            <div class="form-horizontal">
                                <div class="form-body">
                                    <div class="form-group">
                                        <label class="col-md-3 control-label">بازه شماره کمسیون</label>
                                        <div class="col-md-3">
                                            @Html.TextBoxFor(m => m.CommissionNumberRepetitions, new { @class = "form-control" })
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="tab_1_5">
                            <div class="form-horizontal">
                                <div class="form-body">
                                    <div class="form-group">
                                        <label class="col-md-3 control-label">بازه شماره شورا</label>
                                        <div class="col-md-3">
                                           @Html.TextBoxFor(m => m.CouncilNumberRepetitions, new { @class = "form-control" })
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="tab_1_6">
                            <div class="form-horizontal">
                                <div class="form-body">
                                    <div class="form-group">
                                        <label class="col-md-4 control-label">نحوه نمایش اطلاعات درخواست در کارتابل کاربر</label>
                                        <div class="col-md-3">
                                            @Html.DropDownListFor(m => m.Ordinal, TempData["Ordinal"] as IEnumerable<SelectListItem>, "-- - انتخاب-- - ", new { id = "cmbOrdinal", @class = "form-control" })
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</div>

@section Scripts{
    <script src="~/content/assets/global/plugins/bootstrap-fileinput/bootstrap-fileinput.js" type="text/javascript"></script>

    <script>
        function DeleteLogo() {
            $.messager.confirm('confirm', 'حذف شود؟', function (r) {
                if (r) {
                    $.blockUI({ boxed: true, message: '<h4 style="font-family:tahoma;"><img src="/content/assets/global/img/loading-spinner-grey.gif" /> شکیبا باشید...</h4>' });
                    $.post('@Url.Action(MVC.Admin.Settings.DeleteLogo(), "http")', { settingId: $('#deleteLogo').attr('data-id') }, function (result) {
                        $.unblockUI();
                        if (!result.isError) {
                            $('#University_Logo').val("");
                            $('#fileLogo').val("");
                            $('#imgLogo').attr("src", "");
                            $('#divImageLogo').children().attr("src", "");
                            mynotification(result.Message, 'lime');
                        } else {
                            mynotification(result.Message, 'ruby');
                        }
                    }, 'json');
                }
            });
        }
    </script>
}